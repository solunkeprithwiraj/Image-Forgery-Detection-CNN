{% extends "base.html" %} {% block title %}Image Forgery Detection - Home{%
endblock %} {% block content %}
<section class="hero">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-lg-6">
        <h1 class="display-4 fw-bold mb-4">Detect Image Forgery with AI</h1>
        <p class="lead mb-4">
          Our advanced deep learning model can detect manipulated images with
          high accuracy. Upload your image and get instant results.
        </p>
        <div class="d-grid gap-2 d-md-flex justify-content-md-start">
          <a href="#upload-section" class="btn btn-primary btn-lg px-4 me-md-2"
            >Try it now</a
          >
          <a
            href="{{ url_for('about') }}"
            class="btn btn-outline-light btn-lg px-4"
            >Learn more</a
          >
        </div>
      </div>
      <div class="col-lg-6 d-none d-lg-block">
        <div class="hero-image">
          <img
            src="{{ url_for('static', filename='img/hero-image.svg') }}"
            alt="Image Forgery Detection"
            class="img-fluid"
          />
        </div>
      </div>
    </div>
  </div>
</section>

<section id="upload-section" class="py-5">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-md-8">
        <div class="card shadow">
          <div class="card-body p-4">
            <h2 class="text-center mb-4">Upload an Image</h2>

            <form id="upload-form" enctype="multipart/form-data">
              <div class="mb-4">
                <div class="upload-area" id="upload-area">
                  <div class="upload-area-inner">
                    <div class="upload-area-icon-main">
                      <i class="fas fa-cloud-upload-alt"></i>
                    </div>
                    <h3 class="upload-area-title">
                      Drag and drop your image here
                    </h3>
                    <p class="upload-area-description">
                      or
                      <label for="file-input" class="browse-link"
                        >browse files</label
                      >
                    </p>
                  </div>
                  <input
                    type="file"
                    id="file-input"
                    name="file"
                    accept=".jpg,.jpeg,.png,.bmp,.tiff"
                    hidden
                  />
                </div>
              </div>

              <div class="d-grid">
                <button
                  type="submit"
                  class="btn btn-primary btn-lg"
                  id="analyze-btn"
                  disabled
                >
                  <i class="fas fa-search me-2"></i>Analyze Image
                </button>
              </div>
            </form>

            <div id="loading" class="text-center my-4" style="display: none">
              <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
              </div>
              <p class="mt-2">Analyzing image... This may take a moment.</p>
            </div>

            <div id="result" class="mt-4" style="display: none">
              <div class="row">
                <div class="col-md-6">
                  <div class="image-preview-container">
                    <img
                      id="preview-image"
                      src=""
                      alt="Uploaded Image"
                      class="img-fluid rounded"
                    />
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="result-details">
                    <h3 class="result-title mb-3">Analysis Result</h3>
                    <div
                      id="result-authentic"
                      class="result-badge authentic"
                      style="display: none"
                    >
                      <i class="fas fa-check-circle me-2"></i>Authentic
                    </div>
                    <div
                      id="result-tampered"
                      class="result-badge tampered"
                      style="display: none"
                    >
                      <i class="fas fa-exclamation-triangle me-2"></i>Tampered
                    </div>
                    <div class="mt-3">
                      <p>Confidence: <span id="confidence-value">0%</span></p>
                      <div class="progress">
                        <div
                          id="confidence-bar"
                          class="progress-bar"
                          role="progressbar"
                          style="width: 0%"
                        ></div>
                      </div>
                    </div>
                    <div class="mt-4">
                      <button id="try-another" class="btn btn-outline-primary">
                        <i class="fas fa-redo me-2"></i>Try Another Image
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="features py-5 bg-light">
  <div class="container">
    <h2 class="text-center mb-5">How It Works</h2>
    <div class="row g-4">
      <div class="col-md-4">
        <div class="feature-card text-center p-4">
          <div class="feature-icon mb-3">
            <i class="fas fa-brain"></i>
          </div>
          <h3>Deep Learning</h3>
          <p>
            Our model uses a Convolutional Neural Network (CNN) to extract
            features from images.
          </p>
        </div>
      </div>
      <div class="col-md-4">
        <div class="feature-card text-center p-4">
          <div class="feature-icon mb-3">
            <i class="fas fa-puzzle-piece"></i>
          </div>
          <h3>Feature Fusion</h3>
          <p>
            We combine multiple features using advanced fusion techniques for
            better accuracy.
          </p>
        </div>
      </div>
      <div class="col-md-4">
        <div class="feature-card text-center p-4">
          <div class="feature-icon mb-3">
            <i class="fas fa-chart-line"></i>
          </div>
          <h3>SVM Classification</h3>
          <p>
            Support Vector Machine classifier makes the final decision with high
            precision.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>
{% endblock %} {% block extra_js %}
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const uploadForm = document.getElementById("upload-form");
    const fileInput = document.getElementById("file-input");
    const uploadArea = document.getElementById("upload-area");
    const analyzeBtn = document.getElementById("analyze-btn");
    const loading = document.getElementById("loading");
    const result = document.getElementById("result");
    const previewImage = document.getElementById("preview-image");
    const resultAuthentic = document.getElementById("result-authentic");
    const resultTampered = document.getElementById("result-tampered");
    const confidenceValue = document.getElementById("confidence-value");
    const confidenceBar = document.getElementById("confidence-bar");
    const tryAnother = document.getElementById("try-another");

    // Handle drag and drop
    ["dragenter", "dragover", "dragleave", "drop"].forEach((eventName) => {
      uploadArea.addEventListener(eventName, preventDefaults, false);
    });

    function preventDefaults(e) {
      e.preventDefault();
      e.stopPropagation();
    }

    ["dragenter", "dragover"].forEach((eventName) => {
      uploadArea.addEventListener(eventName, highlight, false);
    });

    ["dragleave", "drop"].forEach((eventName) => {
      uploadArea.addEventListener(eventName, unhighlight, false);
    });

    function highlight() {
      uploadArea.classList.add("highlight");
    }

    function unhighlight() {
      uploadArea.classList.remove("highlight");
    }

    uploadArea.addEventListener("drop", handleDrop, false);

    function handleDrop(e) {
      const dt = e.dataTransfer;
      const files = dt.files;
      fileInput.files = files;
      handleFiles(files);
    }

    fileInput.addEventListener("change", function () {
      handleFiles(this.files);
    });

    function handleFiles(files) {
      if (files.length > 0) {
        const file = files[0];
        if (file.type.match("image.*")) {
          analyzeBtn.disabled = false;

          // Show preview
          const reader = new FileReader();
          reader.onload = function (e) {
            uploadArea.innerHTML = `<img src="${e.target.result}" class="preview-thumbnail" alt="Preview">`;
          };
          reader.readAsDataURL(file);
        } else {
          alert("Please upload an image file");
          resetUploadArea();
        }
      }
    }

    uploadForm.addEventListener("submit", function (e) {
      e.preventDefault();

      if (fileInput.files.length === 0) {
        alert("Please select an image to analyze");
        return;
      }

      const formData = new FormData();
      formData.append("file", fileInput.files[0]);

      // Show loading
      uploadForm.style.display = "none";
      loading.style.display = "block";

      // Send request
      fetch("/analyze", {
        method: "POST",
        body: formData,
      })
        .then((response) => {
          if (!response.ok) {
            throw new Error("Network response was not ok");
          }
          return response.json();
        })
        .then((data) => {
          // Hide loading
          loading.style.display = "none";

          // Show result
          result.style.display = "block";

          // Set preview image
          previewImage.src = `/static/${data.image_path}`;

          // Show appropriate result badge
          if (data.prediction === 0) {
            resultAuthentic.style.display = "inline-flex";
            resultTampered.style.display = "none";
            confidenceBar.classList.add("bg-success");
            confidenceBar.classList.remove("bg-danger");
          } else {
            resultAuthentic.style.display = "none";
            resultTampered.style.display = "inline-flex";
            confidenceBar.classList.add("bg-danger");
            confidenceBar.classList.remove("bg-success");
          }

          // Set confidence
          const confidencePercent = (data.confidence * 100).toFixed(2);
          confidenceValue.textContent = `${confidencePercent}%`;
          confidenceBar.style.width = `${confidencePercent}%`;
        })
        .catch((error) => {
          console.error("Error:", error);
          loading.style.display = "none";
          uploadForm.style.display = "block";
          alert(
            "An error occurred while analyzing the image. Please try again."
          );
        });
    });

    tryAnother.addEventListener("click", function () {
      result.style.display = "none";
      uploadForm.style.display = "block";
      resetUploadArea();
    });

    function resetUploadArea() {
      uploadArea.innerHTML = `
                <div class="upload-area-inner">
                    <div class="upload-area-icon-main">
                        <i class="fas fa-cloud-upload-alt"></i>
                    </div>
                    <h3 class="upload-area-title">Drag and drop your image here</h3>
                    <p class="upload-area-description">
                        or <label for="file-input" class="browse-link">browse files</label>
                    </p>
                </div>
            `;
      fileInput.value = "";
      analyzeBtn.disabled = true;
    }
  });
</script>
{% endblock %}
